var y=document.getElementById("taskForm"),d=document.getElementById("taskInput"),p=document.getElementById("queueList"),m=document.getElementById("popBtn"),f=document.getElementById("currentTask"),r=[];function a(){p.innerHTML="",r.forEach(t=>{let e=document.createElement("li");e.textContent=`${t.desc}  \u2022  (${t.priority})`,p.appendChild(e)})}var u=document.getElementById("fileInput"),g=document.getElementById("exportBtn");g.addEventListener("click",()=>{let t={version:1,tasks:r.map(c=>({id:c.id,desc:c.desc}))},e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),s=URL.createObjectURL(e),i=document.createElement("a");i.href=s,i.download=`tasks-${new Date().toISOString().split("T")[0]}.json`,i.click(),URL.revokeObjectURL(s)});u.addEventListener("change",t=>{let e=t.target.files?.[0];if(!e)return;let s=new FileReader;s.onload=i=>{let c=i.target.result;try{let o=JSON.parse(c);if(o.version===1&&Array.isArray(o.tasks)){r=o.tasks.map(n=>({...n,priority:n.desc.length})),r.sort((n,l)=>l.priority-n.priority),a(),u.value="";return}}catch{}c.split(/\r?\n/).forEach(o=>{let n=o.trim();n&&(r.some(l=>l.desc===n)||r.push({id:crypto.randomUUID(),desc:n,priority:n.length}))}),r.sort((o,n)=>n.priority-o.priority),a(),u.value=""},s.readAsText(e)});y.addEventListener("submit",t=>{t.preventDefault();let e=d.value.trim();e&&(r.push({id:crypto.randomUUID(),desc:e,priority:e.length}),r.sort((s,i)=>i.priority-s.priority),d.value="",a())});m.addEventListener("click",()=>{if(!r.length)return;let t=r.shift();f.textContent=`\u25B6 Now doing: ${t.desc}`,a()});a();document.addEventListener("keydown",t=>{t.key==="/"&&!t.ctrlKey&&!t.metaKey&&(t.preventDefault(),d.focus()),t.key==="n"&&!t.ctrlKey&&!t.metaKey&&document.activeElement!==d&&(t.preventDefault(),m.click())});
